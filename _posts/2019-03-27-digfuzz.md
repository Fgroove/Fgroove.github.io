---
layout: post
title:  DigFuzz
date:   2019-03-27 8:55:01 +0800
categories: 基于动态的恶意软件分析
tag: 反沙箱对抗技术
---
* content
{:toc}


# Probabilistic Path Prioritization for Hybrid Fuzzing
## Abstract
---

混合模糊测试结合了模糊测试和协同执行，已成为软件漏洞检测的先进技术。基于对模糊和经验性执行本质上是互补的观察，最先进的混合模糊测试系统部署了“需求启动”和“最佳切换”策略。虽然这些想法听起来很有意思，但由于过于简单的假设，我们指出了它们中的几个基本限制。然后，我们提出了一种新颖的“歧视性调度”策略，以更好地利用有形执行的能力。我们设计了一种新的基于蒙特卡罗的概率路径优先级模型，用于量化每条路径的难度，并优先考虑它们的执行。该模型将模糊测试视为随机抽样过程。它根据采样信息计算每个路径的概率。最后，我们的模型优先考虑并指定最困难的路径来执行。我们实现了原型系统DigFuzz，并使用两个有代表性的数据集评估我们的系统。结果表明，在各个主要方面，DigFuzz中的复杂执行性能优于最先进的混合模糊测试系统。特别是，DigFuzz中的执行执行有助于发现更多的漏洞（12对5），并在CQE数据集上产生比在Driller中执行的更多代码覆盖（18.9％对3.8％）。



## 1. Introduction

软件漏洞被认为是对网络空间最严重的威胁之一。因此，发现一个软件中的漏洞至关重要[12]，[16]，[25]，[27]，[32]。最近，混合模糊测试，模糊测试和执行模式的组合，在漏洞发现中变得越来越流行[5]，[29]，[31]，[39]，[42]，[46]。由于模糊测试和模仿执行本质上是互补的，因此将它们结合起来可以潜在地利用它们的独特优势并减轻弱点。更具体地说，模糊测试是精通探索包含一般分支（具有大的满足值空间的分支）的路径，但是不能探索包含特定分支的路径（具有非常窄的满足值空间的分支）[27]。相反，concolic执行能够生成具体的输入，确保程序沿着特定的执行路径执行，但它会遇到路径爆炸问题[9]。在混合方案中，模糊测试通常承担由于高吞吐量而导致的路径探索的大多数任务，并且模板执行有助于在探索具有低概率的路径中进行模糊测试并且生成满足特定分支的输入。通过这种方式，可以减轻分支执行中的路径爆炸问题，因为分析执行仅负责探索可能阻止模糊测试的低概率路径。

关键的研究问题是如何结合模糊测试和执行模式以实现最佳的整体性能。 Driller [39]和混合动力测试[29]采取“需求启动”策略：模糊测试首先开始，并且只有当模糊测试在一段时间内无法取得任何进展时才会启动模仿执行，等等。最近的一项工作[42]提出了一种“最佳转换”策略：它分别通过模糊和共同执行来量化探索每条路径的成本，并选择更经济的方法来探索这条路径。

我们使用DARPA CQE数据集[13]和LAVA-m数据集[15]评估了“需求启动”和“最佳转换”策略，并发现尽管这些策略听起来很有趣，但由于不符合以下原因，它们都没有充分发挥作用。有元或过度简化的假设。