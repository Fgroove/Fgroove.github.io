---
layout: post
title:   "Syscall & API"
date:   2019-07-02 09:55:01 +0800
categories: "research proposal"
tag: "技术思路"


---

[TOC]



# SYSCALL & API

系统调用：系统调用实际上是指底层的一个调用，就是**内核**提供的、功能十分强大的一系列的函数。这些系统调用是**在内核中实现的**。是操作系统为**用户态运行的进程和硬件设备（如CPU、磁盘、打印机等）进行交互**提供的一组接口，即就是设置在应用程序和硬件设备之间的一个接口层。可以说是操作系统留给用户程序的一个接口。

API：win32API也就是MicrosoftWindows32位平台的应用程序编程接口。windows规定一切的应用程序优先级为3，为windows自己的为0（0最高，3最低）。**windows不允许应用程序直接访问硬件，但是会提供API函数让用户间接地访问**，这样就会**调用系统级API**。

* **用户级API：**替用户写好函数，方便调用，使程序员可以将焦点放在设计程序逻辑上面，而不必再编写繁琐、重复的程序，不必关注技术的细节。例如VC++，MFC，VB等都是类库和各种控件，它代替了API的神秘功能。
* **系统级API：**如果应用程序想要和硬件交互，必须调用此类函数。**程序员调用的是API（api函数**），然后通过与系统调用共同完成函数的功能。因此，**API是**一个提供给应用程序的接口，一组函数，是**与程序猿直接进行交互的**。系统调用则不与程序员进行交互，它是根据API函数，通过一个软件中断机制向内核提交请求（trap指令类似于一个系统中断，系统也会有一个特殊的中断处理函数（interrupt handler）来处理用户的请求），以获得内核服务的接口。并不是所有的API函数都一一对应一个系统的调用，有时，**一个API函数会需要几个系统调用共同来完成函数的功能**，甚至**一些API函数不需要调用相应的系统调用**，不需要内核提供的服务。

## Windows API

摘选自《恶意代码实战分析》第7章 分析恶意Windows程序

Windows API管理着恶意代码与微软程序库之间的交互方式。

### 类型和匈牙利表达法

WindowsAPI是用自己的名字，来表示C语言类型。如`DWORD`和`WORD`分别标识32位和16位无符号整数。

Windows使用匈牙利表达法，作为API函数标识符。

*匈牙利表达法：变量名以一个或多个小写字母开始，代表变量的类型。后面附以变量的名字，变量名以意义明确的大小写混合字母序列所构成。*

