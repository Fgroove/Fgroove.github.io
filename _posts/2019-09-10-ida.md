---
 Javalayout: post
title:   "ida script"
date:   2019-09-10 08:55:01 +0800
categories: "Sandbox Evasion"
tag: "linux-qemu"

---

* content
{:toc}




# IDA Python

主要依赖的包

```python
import idaapi 允许以类的形式，访问更多底层的数据
import idautils 常用的一个模块，大多处理都是需要这个模块 
import idc 兼容IDC函数的模块 
```

## IDC

IDC 是 IDA 扩展的一种脚本语言，用于自动化，或者扩展查询 IDA 数据库。

idc是IDA Python兼容IDC的模块。

* `idc.GetFunctionName(ea)` 返回一个函数名，`ea`可以是函数中的任意二进制地址。
* `idc.Demangle(name, disable_mask)` 还原`name`，`disable_mask`标明如何还原`name`的掩码，通常用 `GetLongPrm(INF_SHORT_DN)` 或 `GetLongPrm(INF_LONG_DN)`获取该掩码。
* `idc.GetMnem(ea)`  获取`ea`地址的反汇编指令。
* `idc.GetMnem(ea)` 获取`ea`地址的反汇编指令操作码。
* `idc.NextHead(ea, maxea)`  获取下一条指令或数据。 `ea` - `maxea`搜索范围。
* `idc.SegEnd(ea)` 获取当前段的结束地址。`ea`可以是该段的任意地址。类似的，`idc.SegStart(ea)`  和 `idc.SegName(ea)`。
*  `idc.wait()` 等待自动分析结束。

## idautils

* `idautils.Heads(start, end)`  获取`start` 和`end`之间的`heads(指令或数据)`列表。
* `idautils.Funtions(start, end)` 
* `idautils.FlowChart()`
* `idautils.get_func()`
* `idautils.get_imagebase()`
* `idautils.Segments()`